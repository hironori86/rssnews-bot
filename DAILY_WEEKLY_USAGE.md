# DXニュース日次・週次運用ガイド

## 概要

このシステムは日次でニュースを収集し、収集したデータから週間ニュースを作成できるように設計されています。

## 基本的な使い方

### 1. 日次ニュース収集・投稿

```bash
# 日次実行（今日のニュースを収集・投稿案を生成）
python main.py --run-now

# 実際に投稿も行う場合
python main.py --run-now --post
```

### 2. 週間ニュース生成

```bash
# 過去7日分のデータから週間ニュースを生成
python weekly_generator.py

# 特定の日数で生成（例：過去5日分）
python weekly_generator.py --days 5

# 出力ディレクトリを指定
python weekly_generator.py --output-dir my_outputs
```

**Windowsユーザーの場合**: `generate_weekly.bat` をダブルクリックで実行可能

## データ構造

### 日次データ
```
outputs/
├── daily/
│   ├── 20241201/           # 日付別フォルダ
│   │   ├── index.json      # インデックスファイル
│   │   └── 20241201_143022/
│   │       ├── raw_data/
│   │       │   └── articles.json  # 生の記事データ
│   │       ├── tweets/
│   │       ├── notes/
│   │       └── summary.json
│   └── 20241202/
│       └── ...
```

### 週間データ
```
outputs/
├── weekly/
│   ├── 20241125_20241201/  # 期間別フォルダ
│   │   └── 20241201_150000/
│   │       ├── tweets/     # 週間ツイート案
│   │       ├── notes/      # 週間note記事案
│   │       └── summary.json
```

## 運用フロー

### 日次運用
1. **毎日定時実行**: `main.py --run-now` を cron/タスクスケジューラで実行
2. **生成されたコンテンツ確認**: `outputs/daily/YYYYMMDD/` フォルダをチェック
3. **SNS投稿**: 生成されたツイート・note記事を確認後、投稿

### 週次運用
1. **週末または週初めに実行**: `weekly_generator.py` を実行
2. **週間サマリー確認**: `outputs/weekly/` フォルダをチェック
3. **週間投稿**: 生成された週間記事を投稿

## 出力ファイルの説明

### 日次出力
- **tweets/**: 日次ツイート案
- **notes/**: 日次note記事案（コピペ可能な形式）
- **raw_data/articles.json**: 週間集計用の生データ
- **summary.json**: 処理結果のサマリー

### 週間出力
- **tweets/**: 週間ツイート案
- **notes/**: 週間note記事案（コピペ可能な形式）
- **summary.json**: 週間処理結果のサマリー

## 主な特徴

### リンク付きコンテンツ
- すべてのnote記事には元記事へのリンクが含まれます
- 読者が詳細を確認できるよう配慮されています

### noteコピペ対応
- 生成されたnote記事は、そのままnoteにコピー&ペーストできる形式です
- マークダウン形式で適切にフォーマットされています

### 重複除去
- 週間ニュース生成時、同じ記事が複数日に渡って収集された場合は自動的に重複除去されます

### カテゴリ分類
- 記事は「最新技術動向」「導入・活用事例」「その他」に自動分類されます

## トラブルシューティング

### 日次データが見つからない場合
- `outputs/daily/` フォルダに対象日のデータが存在するか確認
- 日次実行が正常に完了しているか確認

### 週間生成でエラーが発生する場合
- 過去7日分のうち、最低1日分のデータが必要です
- OpenAI APIキーが正しく設定されているか確認

### 生成されたコンテンツが期待と異なる場合
- `summary.json` でデータの詳細を確認
- 必要に応じて `utils/llm.py` のプロンプトを調整

## 設定ファイル

設定は `.env` ファイルまたは環境変数で行います：

```env
OPENAI_API_KEY=your_openai_api_key
RSS_FEEDS=feed1_url,feed2_url
KEYWORDS=keyword1,keyword2
```

## サポート

問題が発生した場合は、ログファイルを確認し、必要に応じて設定を見直してください。